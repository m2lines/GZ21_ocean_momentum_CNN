# Jupyter notebooks
[gz21-paper-code-zenodo]: https://zenodo.org/record/5076046#.ZF4ulezMLy8
[gz21-paper-agupubs]: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2021MS002534
These Jupyter notebooks were created & used during original development of the
code and associated paper: [Arthur P. Guillaumin, Laure Zanna (2021).
Stochastic-deep learning parameterization of ocean momentum
forcing][gz21-paper-agupubs]. The exact version of the code used to produce said
paper can be found on [Zenodo][gz21-paper-code-zenodo]. 

## 2021 paper figures
There are several notebooks which were used to generate the figures in the 2021 paper.

The data for `generate-paper-figure-1.ipynb` can be generated by running

```
mlflow run . --experiment-name <name>--env-manager=local \
-P lat_min=-80 -P lat_max=80 -P long_min=-280 -P long_max=80 \
-P factor=4 \
-P CO2=1 -P global=0 \
-P ntimes=4000 \
-P chunk_size=1
```
. The notebook generates figure 1b. 

For `generate-paper-figure-6.ipynb`, which generates figure 6b, 
the same call has to be run with again with `CO2=1`. 
The notebook is then asking for the data set with `CO2=0` first and the one with `CO2=1` second.

`test-global-control.ipynb` generates figures 4, 5 and 7, as well as D4 and D5. For this, the inference step with 
the trained neural network has to be run both on the data with `CO2=0` and with `CO2=1`, and then the notebook needs to 
be run once with each set. The paper figures referring to _piControl_ are those with `CO2=0` (the control simulation
with pre-industrial CO2 levels), and the figures referring to _1pctCO2_ are those with `CO2=1` (a 1% increase per 
year in CO2 levels for the first 70 years, after which they remain constant).
The notebook needs to be handed the experiment and run ID of the inference run, which is linked to the data and training 
runs through `params.data_run_id` (run ID of data run) and `params.model_run_id` (run ID of training run), 
respectively.